<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Implements the Compartmentalized Paxos algorithm as described in “Scaling Replicated State Machines with Compartmentalization”, which augments regular Paxos with a cluster of Proxy Leaders."><title>compartmentalized_paxos_core in hydro_test::cluster::compartmentalized_paxos - Rust</title><script>if(window.location.protocol!=="file:")document.head.insertAdjacentHTML("beforeend","SourceSerif4-Regular-6b053e98.ttf.woff2,FiraSans-Italic-81dc35de.woff2,FiraSans-Regular-0fe48ade.woff2,FiraSans-MediumItalic-ccf7e434.woff2,FiraSans-Medium-e1aa3f0a.woff2,SourceCodePro-Regular-8badfe75.ttf.woff2,SourceCodePro-Semibold-aa29a496.ttf.woff2".split(",").map(f=>`<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../static.files/${f}">`).join(""))</script><link rel="stylesheet" href="../../../static.files/normalize-9960930a.css"><link rel="stylesheet" href="../../../static.files/rustdoc-916cea96.css"><meta name="rustdoc-vars" data-root-path="../../../" data-static-root-path="../../../static.files/" data-current-crate="hydro_test" data-themes="" data-resource-suffix="" data-rustdoc-version="1.87.0-nightly (3ea711f17 2025-03-09)" data-channel="nightly" data-search-js="search-e7298875.js" data-settings-js="settings-d72f25bb.js" ><script src="../../../static.files/storage-d8ac8691.js"></script><script defer src="sidebar-items.js"></script><script defer src="../../../static.files/main-a7bf3405.js"></script><noscript><link rel="stylesheet" href="../../../static.files/noscript-893ab5e7.css"></noscript><link rel="alternate icon" type="image/png" href="../../../static.files/favicon-32x32-6580c154.png"><link rel="icon" type="image/svg+xml" href="../../../static.files/favicon-044be391.svg"></head><body class="rustdoc fn"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle" title="show sidebar"></button></nav><nav class="sidebar"><div class="sidebar-crate"><h2><a href="../../../hydro_test/index.html">hydro_<wbr>test</a><span class="version">0.0.0</span></h2></div><div class="sidebar-elems"><section id="rustdoc-toc"><h2 class="location"><a href="#">compartmentalized_<wbr>paxos_<wbr>core</a></h2><h3><a href="#">Sections</a></h3><ul class="block top-toc"><li><a href="#safety" title="Safety">Safety</a></li></ul></section><div id="rustdoc-modnav"><h2><a href="index.html">In hydro_<wbr>test::<wbr>cluster::<wbr>compartmentalized_<wbr>paxos</a></h2></div></div></nav><div class="sidebar-resizer"></div><main><div class="width-limiter"><rustdoc-search></rustdoc-search><section id="main-content" class="content"><div class="main-heading"><div class="rustdoc-breadcrumbs"><a href="../../index.html">hydro_test</a>::<wbr><a href="../index.html">cluster</a>::<wbr><a href="index.html">compartmentalized_paxos</a></div><h1>Function <span class="fn">compartmentalized_paxos_core</span><button id="copy-path" title="Copy item path to clipboard">Copy item path</button></h1><rustdoc-toolbar></rustdoc-toolbar><span class="sub-heading"><a class="src" href="../../../src/hydro_test/cluster/compartmentalized_paxos.rs.html#98-197">Source</a> </span></div><pre class="rust item-decl"><code>pub unsafe fn compartmentalized_paxos_core&lt;'a, P: <a class="trait" href="../paxos/trait.PaxosPayload.html" title="trait hydro_test::cluster::paxos::PaxosPayload">PaxosPayload</a>&gt;(
    proposers: &amp;<a class="struct" href="../../../hydro_lang/location/cluster/struct.Cluster.html" title="struct hydro_lang::location::cluster::Cluster">Cluster</a>&lt;'a, <a class="struct" href="../paxos/struct.Proposer.html" title="struct hydro_test::cluster::paxos::Proposer">Proposer</a>&gt;,
    proxy_leaders: &amp;<a class="struct" href="../../../hydro_lang/location/cluster/struct.Cluster.html" title="struct hydro_lang::location::cluster::Cluster">Cluster</a>&lt;'a, <a class="struct" href="struct.ProxyLeader.html" title="struct hydro_test::cluster::compartmentalized_paxos::ProxyLeader">ProxyLeader</a>&gt;,
    acceptors: &amp;<a class="struct" href="../../../hydro_lang/location/cluster/struct.Cluster.html" title="struct hydro_lang::location::cluster::Cluster">Cluster</a>&lt;'a, <a class="struct" href="../paxos/struct.Acceptor.html" title="struct hydro_test::cluster::paxos::Acceptor">Acceptor</a>&gt;,
    a_checkpoint: <a class="struct" href="../../../hydro_lang/optional/struct.Optional.html" title="struct hydro_lang::optional::Optional">Optional</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a>, <a class="struct" href="../../../hydro_lang/location/cluster/struct.Cluster.html" title="struct hydro_lang::location::cluster::Cluster">Cluster</a>&lt;'a, <a class="struct" href="../paxos/struct.Acceptor.html" title="struct hydro_test::cluster::paxos::Acceptor">Acceptor</a>&gt;, <a class="enum" href="../../../hydro_lang/boundedness/enum.Unbounded.html" title="enum hydro_lang::boundedness::Unbounded">Unbounded</a>&gt;,
    c_to_proposers: impl <a class="trait" href="https://doc.rust-lang.org/nightly/core/ops/function/trait.FnOnce.html" title="trait core::ops::function::FnOnce">FnOnce</a>(<a class="struct" href="../../../hydro_lang/stream/struct.Stream.html" title="struct hydro_lang::stream::Stream">Stream</a>&lt;<a class="struct" href="../paxos/struct.Ballot.html" title="struct hydro_test::cluster::paxos::Ballot">Ballot</a>, <a class="struct" href="../../../hydro_lang/location/cluster/struct.Cluster.html" title="struct hydro_lang::location::cluster::Cluster">Cluster</a>&lt;'a, <a class="struct" href="../paxos/struct.Proposer.html" title="struct hydro_test::cluster::paxos::Proposer">Proposer</a>&gt;, <a class="enum" href="../../../hydro_lang/boundedness/enum.Unbounded.html" title="enum hydro_lang::boundedness::Unbounded">Unbounded</a>&gt;) -&gt; <a class="struct" href="../../../hydro_lang/stream/struct.Stream.html" title="struct hydro_lang::stream::Stream">Stream</a>&lt;P, <a class="struct" href="../../../hydro_lang/location/cluster/struct.Cluster.html" title="struct hydro_lang::location::cluster::Cluster">Cluster</a>&lt;'a, <a class="struct" href="../paxos/struct.Proposer.html" title="struct hydro_test::cluster::paxos::Proposer">Proposer</a>&gt;, <a class="enum" href="../../../hydro_lang/boundedness/enum.Unbounded.html" title="enum hydro_lang::boundedness::Unbounded">Unbounded</a>&gt;,
    config: <a class="struct" href="struct.CompartmentalizedPaxosConfig.html" title="struct hydro_test::cluster::compartmentalized_paxos::CompartmentalizedPaxosConfig">CompartmentalizedPaxosConfig</a>,
) -&gt; (<a class="struct" href="../../../hydro_lang/stream/struct.Stream.html" title="struct hydro_lang::stream::Stream">Stream</a>&lt;<a class="struct" href="../paxos/struct.Ballot.html" title="struct hydro_test::cluster::paxos::Ballot">Ballot</a>, <a class="struct" href="../../../hydro_lang/location/cluster/struct.Cluster.html" title="struct hydro_lang::location::cluster::Cluster">Cluster</a>&lt;'a, <a class="struct" href="../paxos/struct.Proposer.html" title="struct hydro_test::cluster::paxos::Proposer">Proposer</a>&gt;, <a class="enum" href="../../../hydro_lang/boundedness/enum.Unbounded.html" title="enum hydro_lang::boundedness::Unbounded">Unbounded</a>&gt;, <a class="struct" href="../../../hydro_lang/stream/struct.Stream.html" title="struct hydro_lang::stream::Stream">Stream</a>&lt;(<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a>, <a class="enum" href="https://doc.rust-lang.org/nightly/core/option/enum.Option.html" title="enum core::option::Option">Option</a>&lt;P&gt;), <a class="struct" href="../../../hydro_lang/location/cluster/struct.Cluster.html" title="struct hydro_lang::location::cluster::Cluster">Cluster</a>&lt;'a, <a class="struct" href="struct.ProxyLeader.html" title="struct hydro_test::cluster::compartmentalized_paxos::ProxyLeader">ProxyLeader</a>&gt;, <a class="enum" href="../../../hydro_lang/boundedness/enum.Unbounded.html" title="enum hydro_lang::boundedness::Unbounded">Unbounded</a>, <a class="struct" href="../../../hydro_lang/stream/struct.NoOrder.html" title="struct hydro_lang::stream::NoOrder">NoOrder</a>&gt;)</code></pre><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>Implements the Compartmentalized Paxos algorithm as described in “Scaling Replicated State Machines with Compartmentalization”,
which augments regular Paxos with a cluster of Proxy Leaders.</p>
<p>Proposers that wish to broadcast p2as to acceptors or collect p2bs from acceptors instead
go through the Proxy Leaders, which offload networking. The slot is used to determine which Proxy Leader to offload to.
Acceptors are arranged into a grid, where each row and column must have at least f+1 members.
Rows represent “write quorums”; an entire row of acceptors must confirm a payload before it is committed.
Columns represent “read quorums”; an entire column of acceptors must respond to a p1b before a proposer is elected the leader.
Read and write quorums were introduced in “Flexible Paxos: Quorum Intersection Revisited”.</p>
<p>Returns a stream of ballots, where new values are emitted when a new leader is elected,
and a stream of sequenced payloads with an index and optional payload (in the case of
holes in the log).</p>
<h2 id="safety"><a class="doc-anchor" href="#safety">§</a>Safety</h2>
<p>When the leader is stable, the algorithm will commit incoming payloads to the leader
in deterministic order. However, when the leader is changing, payloads may be
non-deterministically dropped. The stream of ballots is also non-deterministic because
leaders are elected in a non-deterministic process.</p>
</div></details></section></div></main></body></html>